# Twin experiments to test DA
 
This project aims to validate and assess the effectiveness of data assimilation techniques by conducting a twin experiment with soil moisture data, ERT 2d profiles and actual ET. 

**True State Generation**
The true state of soil moisture is generated by running a hydrological model with known parameters and forcing data over a 24-hour period. This true state serves as the synthetic reality for the experiment.

```{figure} ./lib/DA_ERT/meshLi_withDA_ic/vtksaturation_slow.gif
:name: true-state-figure
:width: 600px
:align: center

Example of true state generation for soil moisture over a 24-hour period.
```

**Perturbed Initial State**
A new simulation of the hydrological model is initiated with perturbed initial conditions and/or parameters. This represents the model's initial guess, which deviates from the true state.

```{figure} ./lib/DA_ERT/meshLi_withDA_ic/meshLi_withDA_icic.png
:name: meshLi_withDA_ZROOT_WITH_UPDATEZROOT0
:width: 600px
:align: center

meshLi_withDA_ZROOT_WITH_UPDATEZROOT0
```


```{figure} ./lib/DA_ERT/meshLi_withDA_ZROOT_WITH_UPDATE/meshLi_withDA_ZROOT_WITH_UPDATEZROOT0.png
:name: meshLi_withDA_ZROOT_WITH_UPDATEZROOT0
:width: 600px
:align: center

meshLi_withDA_ZROOT_WITH_UPDATEZROOT0
```





**Data Assimilation**
The synthetic observations are assimilated into the hydrological model using the Ensemble Kalman Filter (EnKF) method. This process updates the model state to better match the observations.

**Analysis and Evaluation**
The performance of the data assimilation is evaluated by comparing the assimilated model state with the true state. Metrics such as root mean square error (RMSE) are used to quantify the accuracy of the assimilation.

## SMC at 3 depths
In this experiment, synthetic observations of soil moisture at three different depths are assimilated into a hydrological model every hour over a 24-hour period. Noise is added to the true solution to simulate real-world observation inaccuracies. A 5% Gaussian noise is added to these observations to mimic measurement errors.

 
 
```{figure} ./lib/DA_SMC/SMC_withoutDA_ic/SMC_withoutDA_icsw.png
:name: SMC_withoutDA_icsw
:width: 600px
:align: center

SMC_withoutDA_icsw
```


 
## ERT 2d profiles

```{code-block} TOML
[scenario.ic]
per_type = ["None"]
per_name = ["ic"]
per_nom = [-1]
per_mean = [-1]
per_sigma = [1.75]
per_bounds = ["None"]
sampling_type = ["normal"]
transf_type = ["None"]
listUpdateParm = ["St. var."]
```


## Actual ET

 
