<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Working with pyCATHY and DA with ERT datasets - Introduction</title><meta property="og:title" content="Working with pyCATHY and DA with ERT datasets - Introduction"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/build/fedda32be756a7bce4ae368a71151cc1.png"/><meta property="og:image" content="/build/fedda32be756a7bce4ae368a71151cc1.png"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/build/_assets/app-HGV7ZCRR.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-SJEQ5G4L.css"/><link rel="stylesheet" href="/myst-theme.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rciop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://mystmd.org/guide" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Learn More</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Introduction" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">Introduction</a><a title="Twin experiments to test DA" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/resultsda">Twin experiments to test DA</a><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Notebook" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Notebook</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R3d8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R3d8p:" class="pl-3 pr-[2px] collapsible-content"><a title="Working with pyCATHY and DA" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/da-ert-part1-solution">Working with pyCATHY and DA</a><a title="Working with pyCATHY and DA" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/da-ert-part2-runda">Working with pyCATHY and DA</a><a title="Working with pyCATHY and DA with ERT datasets" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/da-ert-part3-results-archie-inprogress">Working with pyCATHY and DA with ERT datasets</a><a title="Working with pyCATHY and DA with ERT datasets" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/da-ert-part3-results-ert-inprogress">Working with pyCATHY and DA with ERT datasets</a><a title="Working with pyCATHY and DA" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/da-smc-sensors-part1-solution">Working with pyCATHY and DA</a><a title="Working with pyCATHY and DA" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/da-smc-sensors-part2-plotda">Working with pyCATHY and DA</a><a title="Working with pyCATHY and DA" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/da-swc-ert-performance">Working with pyCATHY and DA</a></div></div></div></nav><div class="flex-none py-4 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap" style="margin-top:60px"><main class="article-grid subgrid-gap col-screen"><div class="sticky z-10 hidden h-0 col-margin-right-inset lg:block" style="top:60px"><nav></nav></div><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="pt-5 mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">Tutorial</div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://github.com/BenjMy/ETH_pyCATHY/" title="GitHub Repository: BenjMy/ETH_pyCATHY/" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:R1khtop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Working with pyCATHY and DA with ERT datasets</h1><p class="mt-2 mb-0 lead text-zinc-600 dark:text-zinc-400">PART3 - plotting the **Archie** transformation results</p><header class="mt-4 not-prose"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div><span class="font-semibold text-sm"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R5qhtop:" data-state="closed">Benjamin Mary</button><a class="ml-1" href="mailto:benjamin.mary@ica.csic.es" title="Benjamin Mary &lt;benjamin.mary@ica.csic.es&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a><a class="ml-1" href="https://orcid.org/0000-0001-7199-2885" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>ICA-CSIC<!-- --> </div></div></div></header><div class="flex mt-2 text-sm font-light"><time dateTime="2024/04/12" class="">April 11, 2024</time></div></div><div id="skip-to-article"></div><div id="WD9sHsaYkt" class="relative group/block article-grid subgrid-gap col-screen"><img id="jK4nFvm3zW" style="margin:0 auto" src="/build/fedda32be756a7bce4ae368a71151cc1.png" alt="image.png" data-canonical-url="data:image/png;base64,iVBORw0KGg...lFTkSuQmCC"/></div><div id="dfkMsHUTwD" class="relative group/block article-grid subgrid-gap col-screen"><p>The notebooks describe:</p><p><strong>Plot outputs</strong>: analysis of the results</p><ul><li><span data-state="closed"><a class="hover-link" href="/da-ert-part3-results-archie-inprogress#plot-states">Saturation with uncertainties</a></span></li><li><span data-state="closed"><a class="hover-link" href="/da-ert-part3-results-archie-inprogress#parm-evol">Parameters convergence</a></span></li><li><span data-state="closed"><a class="hover-link" href="/da-ert-part3-results-archie-inprogress#da-perf">Assimilation performance</a></span></li></ul></div><div id="xqr1RpHjNs" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">import pyCATHY
from pyCATHY import cathy_tools
from pyCATHY.DA.cathy_DA import DA, dictObs_2pd
from pyCATHY.DA.perturbate import perturbate_parm
from pyCATHY.DA import perturbate
from pyCATHY.DA.observations import read_observations, prepare_observations, make_data_cov
from pyCATHY.DA import performance
from pyCATHY.ERT import petro_Archie as Archie
import pyCATHY.meshtools as cathy_meshtools
import pyvista as pv
import pyCATHY.plotters.cathy_plots as cplt 
import os 
import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
# set some default plotting parameters for nicer looking plots
mpl.rcParams.update({&quot;axes.grid&quot;:True, 
                     &quot;grid.color&quot;:&quot;gray&quot;, 
                     &quot;grid.linestyle&quot;:&#x27;--&#x27;,
                     &#x27;figure.figsize&#x27;:(6,6)}
                   )
import pandas as pd
import utils</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HXur77igFViJX2Uin5ltG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xdqc8EVkoB" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">import pygimli as pg 
from pygimli.physics import ert</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bcXiGEMKxlnIfMBwc26r6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zYpIHtZKJz" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="plot-results" class="relative group"><span class="heading-text">Analysis of the results</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="pbEJ6HGYFE" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="reload-solution" class="relative group"><span class="heading-text">Reload solution</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#reload-solution" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="ZJBc3UQpDl" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simu_solution = cathy_tools.CATHY(
                                    dirName=&#x27;./solution_ERT&#x27;,
                                    prj_name= &#x27;weill_dataset&#x27;,
                                    notebook=True,
                                  )
sw_SOL, sw_SOL_times = simu_solution.read_outputs(&#x27;sw&#x27;)
psi_SOL = simu_solution.read_outputs(&#x27;psi&#x27;)

rootMap, rootMap_hd = simu_solution.read_inputs(&#x27;root_map&#x27;)

soil_SPP_SOL, soil_FP_SOL = simu_solution.read_inputs(&#x27;soil&#x27;,
                                                         MAXVEG=int(np.max(rootMap)),
                                                    )
PERMX_SOL = soil_SPP_SOL[&#x27;PERMX&#x27;].unique()[0]
POROS_SOL = soil_SPP_SOL[&#x27;POROS&#x27;].unique()[0]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="T6IeAswjFXxIWd9811eve" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="I6Ix85Cxt1" class="relative group/block article-grid subgrid-gap col-screen"><h4 id="plot-saturation-2d-solution" class="relative group"><span class="heading-text">Plot saturation 2D solution</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-saturation-2d-solution" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="qAsYsrnqPM" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">pl = pv.Plotter(shape=(2, 2))
axis_pl = [(0,0),(0,1),(1,0),(1,1)]
for i, j in enumerate([0,2,5,10]):
    mesh = pv.read(os.path.join(simu_solution.workdir,
                                &#x27;solution_ERTsaturation_nearIntrp2_pg_msh&#x27; + str(j) + &#x27;.vtk&#x27;,
                                )
    
           )
    pl.subplot(axis_pl[i][0],axis_pl[i][1])
    pl.add_mesh(mesh,
               scalars=&#x27;saturation_nearIntrp2_pg_msh&#x27;,
                lighting=False,
                cmap=&quot;jet_r&quot;
               )
    pl.view_xz()
pl.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="uanRxPesKXhUGuYgQW9vv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/6ae9872eb651581ce270554502af7ba2.png" alt="&lt;PIL.Image.Image image mode=RGB size=1024x768&gt;"/></div></div><div id="uVqrClcMMd" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="going-further-with-pygimli-time-lapse" class="relative group"><span class="heading-text">Going further with pygimli Time Lapse</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#going-further-with-pygimli-time-lapse" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="iupS1dzMH0" class="relative group/block article-grid subgrid-gap col-screen"><p>In case we want to see the results in term of ER, we can invert the apparent resistivities. See: <a target="_blank" href="https://www.pygimli.org/_examples_auto/3_ert/plot_09_timelapse.html" rel="noreferrer">https://<wbr/>www<wbr/>.pygimli<wbr/>.org<wbr/>/<wbr/>_examples<wbr/>_auto<wbr/>/3<wbr/>_ert<wbr/>/plot<wbr/>_09<wbr/>_timelapse<wbr/>.html</a></p><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-text" style="white-space:pre">for i in range(10):
    rhoa = pg.load(&#x27;filenameRhoa_synthetic&#x27;)
    DATA.append(rhoa)

tl = ert.TimelapseERT(DATA)
tl.invert(zWeight=0.3, lam=100)
tl.showAllModels();</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><div id="nZ3OZj4PMs" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="reload-da-results" class="relative group"><span class="heading-text">Reload DA results</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#reload-da-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="SktQdRpZ3q" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simuWithDA = DA(
                        dirName=&#x27;./DA_ERT&#x27;,
                        prj_name= &#x27;Weill_example_withDA&#x27;,
                        notebook=True,
                    )
simuWithoutDA = DA(
                        dirName=&#x27;./DA_ERT&#x27;,
                        prj_name= &#x27;Weill_example_withoutDA&#x27;,
                        notebook=True,
                    )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nZ-rFRxXD1XyNfaAc9ZJ7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="DNL2jhXwlj" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">results_withDA = simuWithDA.load_pickle_backup()
results_withoutDA = simuWithoutDA.load_pickle_backup()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="V0jrpw8hmjoqGvu9CSefV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="rGC41S8OJr" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">observations = dictObs_2pd(results_withDA[&#x27;dict_obs&#x27;])
#observations.xs(&#x27;ERT&#x27;,0).iloc[0][&#x27;elecs&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xpsdawXIf3dQ2z0BzR7Rk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wflbPfDlGY" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">tobs= observations.index.get_level_values(1).to_list()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="70iJIKknpXphXJhegDlnF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="FqxUPFXXx6" class="relative group/block article-grid subgrid-gap col-screen"><h4 id="ert-simulate" class="relative group"><span class="heading-text">ERT simulate</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#ert-simulate" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Here we simulate the apparent resistivities from the mean/min/max of the ensemble generated from data assimilation for each steps.</p></div><div id="RCigq974hc" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">os.getcwd()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="e0nQ7a6NElPw1q6y4l-7r" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&#x27;/home/z0272571a@CAMPUS.CSIC.ES/Nextcloud/BenCSIC/Codes/BenjMy/ETH_pyCATHY/notebooks&#x27;</span></code></div></div></div><div id="rLa08YW8Gf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">meshCiPG_PGref = pv.read(&#x27;./solution_ERT/meshCi.vtk&#x27;)
meshLiPG_PGref = pv.read(&#x27;./solution_ERT/meshLi.vtk&#x27;)
(meshCiPG, meshLiPG) = utils.define_mesh_transformations(meshCiPG_PGref,
                                                      meshLiPG_PGref,
                                                      idC=10, 
                                                      idL=10,
                                                    )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SB4AQS_HmrOp52HkR8wjD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wGGSK5H0zy" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">meshLiPG</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gHi7YMcF_6lAjorSktlaB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="R8Q3xu5Bbz" class="relative group/block article-grid subgrid-gap col-screen"><ul><li>meshLiPG is composed of 3114 cells and 1658 nodes</li></ul></div><div id="I0lalIZGJI" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">pl = pv.Plotter()
pl.add_mesh(meshCiPG)
pl.add_mesh(meshLiPG)
#pl.add_mesh(meshCATHY,opacity=0.5)
pl.show_grid()
pl.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PlgmJrdEdOIfVXMdfoofS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/0a59c637b77ab96fdbe7b19cf8fa1d13.png" alt="&lt;PIL.Image.Image image mode=RGB size=1024x768&gt;"/></div></div><div id="vW4AZ4aBXD" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ERT_meta_dict_meshLi={
                &#x27;forward_mesh_vtk_file&#x27;: &#x27;./solution_ERT/meshLi.vtk&#x27;,
                &#x27;mesh_nodes_modif&#x27;: meshLiPG.points
}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qVuIuHEGHjwwQmRr1s0HS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XOQCIRzrrs" class="relative group/block article-grid subgrid-gap col-screen"><h4 id="define-archie-parameters" class="relative group"><span class="heading-text">Define Archie Parameters</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-archie-parameters" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="j7wbCpswMK" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">sc = {}
rFluid_Archie = 1/(588*(1e-6/1e-2))
sc = {
    &quot;POROS&quot;: [POROS_SOL],
    &quot;rFluid_Archie&quot;: [rFluid_Archie],
    &quot;a_Archie&quot;: [0.3],
    &quot;m_Archie&quot;: [1.7],
    &quot;n_Archie&quot;: [1.7],
    &quot;pert_sigma_Archie&quot;: [0],
}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Nnr-1NwlsXH5Pd9SBnHGT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="D17a6PFpah" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"></code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Q0CcXniJCYfgm2sA_03el" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">NameError</span><span>                                 Traceback (most recent call last)
Cell </span><span style="color:rgb(0, 187, 0)">In[32], line 1</span><span>
</span><span style="color:rgb(0, 187, 0)">----&gt; 1</span><span> meshLi_PG_withSaturation, scalar_new </span><span style="color:rgb(undefined, undefined, undefined)">=</span><span> cathy_meshtools</span><span style="color:rgb(undefined, undefined, undefined)">.</span><span>CATHY_2_pg(meshCATHY,
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      2</span><span>                                                                   ERT_meta_dict_meshLi,
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      3</span><span>                                                                   </span><span style="color:rgb(95, 135, 135);font-style:italic"># show=True,</span><span>
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      4</span><span>                                                                   )

</span><span style="color:rgb(187, 0, 0)">NameError</span><span>: name &#x27;meshCATHY&#x27; is not defined</span></code></pre></div></div></div><div id="xNyARZkkCJ" class="relative group/block article-grid subgrid-gap col-screen"><h4 id="create-ert-scheme" class="relative group"><span class="heading-text">Create ERT scheme</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-ert-scheme" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="l7dbbIMKNB" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">scheme = ert.createData(elecs=np.linspace(start=0, 
                                          stop=10, 
                                          num=21),
                           schemeName=&#x27;dd&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bswYwbwPfKNGtQf3BlTJM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AGghJETmaQ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">meshLi = pg.load(ERT_meta_dict_meshLi[&#x27;forward_mesh_vtk_file&#x27;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="G4hbMru5DR0d6EADWjQIf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="HOdmjabhEe" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">sw_bef_update_withDA_ens1 = results_withDA[&#x27;df_DA&#x27;].set_index([&#x27;time&#x27;,&#x27;Ensemble_nb&#x27;])[&#x27;sw_bef_update_&#x27;].xs((1,0))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BYcHTnMQl4qEDG2KHu-7b" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="A55fkVdaZF" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">results_withDA_Archie = results_withDA[&#x27;df_Archie&#x27;].set_index([&#x27;time&#x27;,&#x27;ens_nbi&#x27;])
results_withDA_Archie</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gaN94tNF73_vS79Y1yP1a" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="nsrEzmn5tf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">rhomap = results_withDA_Archie.xs((0,0))[&#x27;ER_converted&#x27;].values
len(rhomap)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gnH2PeRANy_8r5ZHTIlUN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>7056</span></code></div></div></div><div id="TZooIguKVh" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">len(rhomap)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VttAK5fePy8e847ajM_Yb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>7056</span></code></div></div></div><div id="JLpQtaHXC2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">meshLi</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UcI0p2sZ7t5X8aaMRvkpi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>Mesh: Nodes: 1658 Cells: 3114 Boundaries: 4771
Mesh contains data: Marker</span></code></div></div></div><div id="xPau8M62Uq" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">os.getcwd()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="12s_5cC9kPTy1c8mdBO5T" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&#x27;/home/z0272571a@CAMPUS.CSIC.ES/Nextcloud/BenCSIC/Codes/BenjMy/ETH_pyCATHY/notebooks&#x27;</span></code></div></div></div><div id="QeIErozdlj" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">for i in range(len(tatmbc)):

    # read in CATHY mesh data
    # ------------------------------------------------------------------------
    path_CATHY = os.path.join(simu_solution.workdir, 
                              simu_solution.project_name , 
                              &#x27;vtk/&#x27;
                              )
    if i&lt;10:    
        filename = &quot;10&quot; + str(i) + &quot;.vtk&quot;
    elif i&lt;100:
        filename = &quot;1&quot; + str(i) + &quot;.vtk&quot;
    
    meshCATHY = pv.read(path_CATHY+filename)
            
    meshLi_PG_withSaturation, scalar_new = cathy_meshtools.CATHY_2_pg(meshCATHY,
                                                                      ERT_meta_dict_meshLi,
                                                                      # show=True,
                                                                      )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Lgha7R8Renrm-45L6N0mM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="adXorq1cyQ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">
for i in range(len(tobs)):
    rhomap = results_withDA_Archie.xs((0,0))[&#x27;ER_converted&#x27;].values
    print(rhomap)

    meshLi_PG_withSaturation, scalar_new = cathy_meshtools.CATHY_2_pg(meshCATHY,
                                                                  ERT_meta_dict_meshLi,
                                                                  # show=True,
                                                                  )

    ER_converted_ti_noNoise = Archie.Archie_rho_DA(
                                               sat = [saturation],
                                               rFluid_Archie=sc[&#x27;rFluid_Archie&#x27;], 
                                               porosity=sc[&#x27;POROS&#x27;], 
                                               a_Archie=sc[&#x27;a_Archie&#x27;], 
                                               m_Archie=sc[&#x27;m_Archie&#x27;], 
                                               n_Archie=sc[&#x27;n_Archie&#x27;],
                                               pert_sigma_Archie=[0]
                                               )

    data = ert.simulate(meshLi, 
                        scheme=scheme, 
                        res=rhomap, 
                        noiseLevel=1,
                        noiseAbs=1e-6, 
                        seed=1337
                        )
    print(i)
    data.save(&#x27;DA_ERT/ERTsimuWithDA/ERT_Li_&#x27; + str(i) + &#x27;.data&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RY5Akq4knrbLKVYt_dS5a" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>[27.6381372  27.66551909 27.66061108 ... 14.09702132 14.09702132
 14.09702132]
ModellingBase::setMesh() copying new mesh ... Found Neumann domain. Setting topography=1.
Found Neumann domain. but 2.5D -&gt; neumann: false
Mesh: Nodes: 1658 Cells: 3114 Boundaries: 4771
Mesh contains data: Marker
res:  [27.6381372  27.66551909 27.66061108 ... 14.09702132 14.09702132
 14.09702132]
Found datafile: 21 electrodes
Found: 21 free-electrodes
rMin = 0.25, rMax = 20
NGauLeg + NGauLag for inverse Fouriertransformation: 11 + 4
Found non-Neumann domain
0.00733017 s
FOP updating mesh dependencies ... 1.072e-06 s
</span></code></pre></div><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">BaseException</span><span>                             Traceback (most recent call last)
Cell </span><span style="color:rgb(0, 187, 0)">In[29], line 4</span><span>
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      2</span><span> rhomap </span><span style="color:rgb(undefined, undefined, undefined)">=</span><span> results_withDA_Archie</span><span style="color:rgb(undefined, undefined, undefined)">.</span><span>xs((</span><span style="color:rgb(undefined, undefined, undefined)">0</span><span>,</span><span style="color:rgb(undefined, undefined, undefined)">0</span><span>))[</span><span style="color:rgb(175, 0, 0)">&#x27;</span><span style="color:rgb(175, 0, 0)">ER_converted</span><span style="color:rgb(175, 0, 0)">&#x27;</span><span>]</span><span style="color:rgb(undefined, undefined, undefined)">.</span><span>values
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      3</span><span> </span><span style="color:rgb(0, 135, 0)">print</span><span>(rhomap)
</span><span style="color:rgb(0, 187, 0)">----&gt; 4</span><span> data </span><span style="color:rgb(undefined, undefined, undefined)">=</span><span> ert</span><span style="color:rgb(undefined, undefined, undefined)">.</span><span>simulate(meshLi, 
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      5</span><span>                     scheme</span><span style="color:rgb(undefined, undefined, undefined)">=</span><span>scheme, 
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      6</span><span>                     res</span><span style="color:rgb(undefined, undefined, undefined)">=</span><span>rhomap, 
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      7</span><span>                     noiseLevel</span><span style="color:rgb(undefined, undefined, undefined)">=</span><span style="color:rgb(undefined, undefined, undefined)">1</span><span>,
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      8</span><span>                     noiseAbs</span><span style="color:rgb(undefined, undefined, undefined)">=</span><span style="color:rgb(undefined, undefined, undefined)">1e-6</span><span>, 
</span><span style="color:rgb(0, 187, 0);font-weight:bold">      9</span><span>                     seed</span><span style="color:rgb(undefined, undefined, undefined)">=</span><span style="color:rgb(undefined, undefined, undefined)">1337</span><span>
</span><span style="color:rgb(0, 187, 0);font-weight:bold">     10</span><span>                     )
</span><span style="color:rgb(0, 187, 0);font-weight:bold">     11</span><span> </span><span style="color:rgb(0, 135, 0)">print</span><span>(i)
</span><span style="color:rgb(0, 187, 0);font-weight:bold">     12</span><span> data</span><span style="color:rgb(undefined, undefined, undefined)">.</span><span>save(</span><span style="color:rgb(175, 0, 0)">&#x27;</span><span style="color:rgb(175, 0, 0)">DA_ERT/ERTsimuWithDA/ERT_Li_</span><span style="color:rgb(175, 0, 0)">&#x27;</span><span> </span><span style="color:rgb(undefined, undefined, undefined)">+</span><span> </span><span style="color:rgb(0, 135, 0)">str</span><span>(i) </span><span style="color:rgb(undefined, undefined, undefined)">+</span><span> </span><span style="color:rgb(175, 0, 0)">&#x27;</span><span style="color:rgb(175, 0, 0)">.data</span><span style="color:rgb(175, 0, 0)">&#x27;</span><span>)

File </span><span style="color:rgb(0, 187, 0)">~/miniconda3/envs/pgCATHY/lib/python3.11/site-packages/pygimli/physics/ert/ert.py:215</span><span>, in </span><span style="color:rgb(0, 187, 187)">simulate</span><span style="color:rgb(0, 0, 187)">(mesh, scheme, res, **kwargs)</span><span>
</span><span style="color:rgb(0, 187, 0);font-weight:bold">    213</span><span>         </span><span style="color:rgb(0, 135, 0)">print</span><span>(mesh)
</span><span style="color:rgb(0, 187, 0);font-weight:bold">    214</span><span>         </span><span style="color:rgb(0, 135, 0)">print</span><span>(</span><span style="color:rgb(175, 0, 0)">&quot;</span><span style="color:rgb(175, 0, 0)">res: </span><span style="color:rgb(175, 0, 0)">&quot;</span><span>, res)
</span><span style="color:rgb(0, 187, 0)">--&gt; 215</span><span>         </span><span style="color:rgb(0, 135, 0);font-weight:bold">raise</span><span> </span><span style="color:rgb(215, 95, 95);font-weight:bold">BaseException</span><span>(
</span><span style="color:rgb(0, 187, 0);font-weight:bold">    216</span><span>             </span><span style="color:rgb(175, 0, 0)">&quot;</span><span style="color:rgb(175, 0, 0)">Simulate called with wrong resistivity array.</span><span style="color:rgb(175, 0, 0)">&quot;</span><span>)
</span><span style="color:rgb(0, 187, 0);font-weight:bold">    218</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">if</span><span> </span><span style="color:rgb(175, 0, 255);font-weight:bold">not</span><span> isArrayData:
</span><span style="color:rgb(0, 187, 0);font-weight:bold">    219</span><span>     ret[</span><span style="color:rgb(175, 0, 0)">&#x27;</span><span style="color:rgb(175, 0, 0)">rhoa</span><span style="color:rgb(175, 0, 0)">&#x27;</span><span>] </span><span style="color:rgb(undefined, undefined, undefined)">=</span><span> rhoa

</span><span style="color:rgb(187, 0, 0)">BaseException</span><span>: Simulate called with wrong resistivity array.</span></code></pre></div></div></div><div id="I8dT5M0zhP" class="relative group/block article-grid subgrid-gap col-screen"><h4 id="archie" class="relative group"><span class="heading-text">Archie</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#archie" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="cWOCf3f755" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">results_withDA.keys()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Bi1K66l2rWMwOXeDsNmxx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MokWh981PS" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">Archie = results_withDA[&#x27;df_Archie&#x27;]
Archie_ER = Archie.set_index([&#x27;time&#x27;,&#x27;ens_nbi&#x27;])
Archie_ER</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0i-cWHkJ0-GM8nukjfcuj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="IKWMWHPYhR" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">Archie.time.unique()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HtZvDw_zNFKRiLsKf9D0z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="lcJUKAjJLh" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">meanArchie = Archie.groupby(&#x27;time&#x27;)[&#x27;ER_converted&#x27;].mean()
minArchie = Archie.groupby(&#x27;time&#x27;)[&#x27;ER_converted&#x27;].min()
maxArchie = Archie.groupby(&#x27;time&#x27;)[&#x27;ER_converted&#x27;].max()
minArchie</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cJWmf6_vtqJVrfMCKGmDE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zFQ3u9I4A6" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots()
minArchie.plot(ax=ax)
maxArchie.plot(ax=ax)
meanArchie.plot(ax=ax)
ax.set_xlabel(&#x27;# Assimilation&#x27;)
ax.set_ylabel(&#x27;ER converted&#x27;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4ehziH3zNVJXEzYlWlbMQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LMVb9r0dQm" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="plot-1-1-line-between-observed-er-and-estimated-er" class="relative group"><span class="heading-text">Plot 1:1 line between observed ER and estimated ER</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-1-1-line-between-observed-er-and-estimated-er" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="CKXRigjbF4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">Archie[&#x27;ER_converted&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-mt5qD5m5QI-_HdSH5E3q" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VlSPXxgB5H" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">metadata_ERT    = {
                    &#x27;data_type&#x27;: &#x27;$ERT$&#x27;, # units
                    &#x27;units&#x27;: &#x27;$\Ohm$&#x27;, # units transfer_resistances
                    &#x27;forward_mesh_vtk_file&#x27;: &#x27;../solution_ERT/meshLi.vtk&#x27;, # path to the ERT mesh (vtk file compatible with pygimli or resipy)
                    # &#x27;sequenceERT&#x27;: sequenceERT, # path to the ERT sequence  (file compatible with pygimli or resipy)
                    # &#x27;instrument&#x27;: &#x27;Syscal&#x27;, # Instrument
                    &#x27;data_format&#x27;: &#x27;pygimli&#x27;, # format (raw or preprocessed)
                    &#x27;dataErr&#x27;: 0.5, # error in %
                    &#x27;fwdNoiseLevel&#x27;: 5, # error in %
                    #&#x27;mesh_nodes_modif&#x27;: meshLiPG.points, 
        
                }</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xauk-GIwoSytU_EQiMWCP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Jtv0cPv1B0" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dict_obs = {}
for i, tt in enumerate(Archie.time.unique()):

    if i == 0:
        continue
    
    # .data file observation generated by pygimli
    filename = os.path.join(simu_solution.workdir,
                            &#x27;ERTsolution&#x27;, 
                            &#x27;ERT_Li_&#x27; + str(i) + &#x27;.data&#x27;
                            )    
    data_measure = read_observations(
                                    dict_obs,
                                    filename, 
                                    data_type = &#x27;ERT&#x27;, 
                                    data_err = 0.5,
                                    show=True,
                                    tA=tt,
                                    obs_cov_type=&#x27;data_err&#x27;, #data_err
                                    meta=metadata_ERT,
                                    ) 
data_measure_df = dictObs_2pd(dict_obs) </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZjOMAREZM9YUKaN-pRLoV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RiReXeQT7z" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">data_rhoa = data_measure_df.xs(&#x27;ERT&#x27;)[&#x27;data&#x27;]
data_rhoa.iloc[0].head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="J4MyNuWHzhg4b2-xzteWv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UmXCVxhxVa" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots() 
ax.scatter(data_rhoa.iloc[0][&#x27;rhoa&#x27;].values,
           Archie.groupby(&#x27;ens_nbi&#x27;)[&#x27;ER_converted&#x27;].mean().values
          )
           </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-4lJyrQI5O7JSYzTKVrJu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/da-ert-part3-results-archie-inprogress"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Notebook</div>Working with pyCATHY and DA with ERT datasets</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/da-smc-sensors-part1-solution"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Notebook</div>Working with pyCATHY and DA</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((o,u)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let d=JSON.parse(sessionStorage.getItem(o)||"{}")[u||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(f){console.error(f),sessionStorage.removeItem(o)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-K6EYMIDZ.js"/><link rel="modulepreload" href="/build/_shared/chunk-FBLNPC3V.js"/><link rel="modulepreload" href="/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-UH5JPP7T.js"/><link rel="modulepreload" href="/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/build/_shared/chunk-HTHE5KDW.js"/><link rel="modulepreload" href="/build/_shared/chunk-XDQ422TJ.js"/><link rel="modulepreload" href="/build/_shared/chunk-6TYLRLOL.js"/><link rel="modulepreload" href="/build/_shared/chunk-QB27XQSF.js"/><link rel="modulepreload" href="/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-6OG4MV7A.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-MAN6ELAR.js"/><link rel="modulepreload" href="/build/_shared/chunk-CD47MMBM.js"/><link rel="modulepreload" href="/build/routes/$-KBJJKE3L.js"/><script>window.__remixContext = {"url":"/da-ert-part3-results-ert-inprogress","state":{"loaderData":{"root":{"theme":"light","config":{"options":{},"myst":"1.2.7","nav":[],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"github":"https://github.com/BenjMy/ETH_pyCATHY","keywords":[],"id":"9ccbb88f-e40f-414b-8884-6d4ec2e81795","exports":[],"bibliography":[],"title":"Introduction","index":"readme","pages":[{"slug":"resultsda","title":"Twin experiments to test DA","description":"","date":"","thumbnail":"/build/atmbc-f09b5504b84b8c8eec07ec45739288f2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"title":"Notebook","level":1},{"slug":"da-ert-part1-solution","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part2-runda","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part3-results-archie-inprogress","title":"Working with pyCATHY and DA with ERT datasets","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part3-results-ert-inprogress","title":"Working with pyCATHY and DA with ERT datasets","description":"","date":"2024/04/12","thumbnail":"/build/fedda32be756a7bce4ae368a71151cc1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-smc-sensors-part1-solution","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-smc-sensors-part2-plotda","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-swc-ert-performance","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"options":{},"myst":"1.2.7","nav":[],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"github":"https://github.com/BenjMy/ETH_pyCATHY","keywords":[],"id":"9ccbb88f-e40f-414b-8884-6d4ec2e81795","exports":[],"bibliography":[],"title":"Introduction","index":"readme","pages":[{"slug":"resultsda","title":"Twin experiments to test DA","description":"","date":"","thumbnail":"/build/atmbc-f09b5504b84b8c8eec07ec45739288f2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"title":"Notebook","level":1},{"slug":"da-ert-part1-solution","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part2-runda","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part3-results-archie-inprogress","title":"Working with pyCATHY and DA with ERT datasets","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part3-results-ert-inprogress","title":"Working with pyCATHY and DA with ERT datasets","description":"","date":"2024/04/12","thumbnail":"/build/fedda32be756a7bce4ae368a71151cc1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-smc-sensors-part1-solution","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-smc-sensors-part2-plotda","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-swc-ert-performance","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"kind":"Notebook","sha256":"b99192a1ea9684f7577cb7b7bd2d3cb6b3126029886f77994673832a4e3dcbbb","slug":"da-ert-part3-results-ert-inprogress","location":"/notebook/DA_ERT_part3_results-ERT_inprogress.ipynb","dependencies":[],"frontmatter":{"title":"Working with pyCATHY and DA with ERT datasets","subtitle":"PART3 - plotting the **Archie** transformation results","github":"https://github.com/BenjMy/ETH_pyCATHY/","authors":[{"nameParsed":{"literal":"Benjamin Mary","given":"Benjamin","family":"Mary"},"name":"Benjamin Mary","orcid":"0000-0001-7199-2885","corresponding":true,"email":"benjamin.mary@ica.csic.es","affiliations":["ICA-CSIC"],"id":"contributors-DA_ERT_part3_results-ERT_inprogress-generated-uid-0"}],"affiliations":[{"id":"ICA-CSIC","name":"ICA-CSIC"}],"date":"2024/04/12","license":{"content":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"subject":"Tutorial","keywords":[],"thumbnail":"/build/fedda32be756a7bce4ae368a71151cc1.png","exports":[{"format":"ipynb","filename":"DA_ERT_part3_results-ERT_inprogress.ipynb","url":"/build/DA_ERT_part3_results-521b7b28fe5565f9263b95f78e6541cb.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"image","url":"/build/fedda32be756a7bce4ae368a71151cc1.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jK4nFvm3zW","urlSource":"data:image/png;base64,iVBORw0KGg...lFTkSuQmCC"}],"key":"WD9sHsaYkt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The notebooks describe:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"grE87PhqDi"}],"key":"AusgGEpUlH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Plot outputs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Vjw2zTQF73"}],"key":"fkYt40J0NZ"},{"type":"text","value":": analysis of the results","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NrALv8UJq4"}],"key":"ks8XIUJYl9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Saturation with uncertainties","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Nutch779uA"}],"identifier":"plot_states","label":"plot_states","kind":"heading","template":"{name}","resolved":true,"html_id":"plot-states","remote":true,"url":"/da-ert-part3-results-archie-inprogress","dataUrl":"/da-ert-part3-results-archie-inprogress.json","key":"yTTrbMU7XG"}],"key":"rjcMIWuie1"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Parameters convergence","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WglR8tA9Dz"}],"identifier":"parm_evol","label":"Parm_evol","kind":"heading","template":"{name}","resolved":true,"html_id":"parm-evol","remote":true,"url":"/da-ert-part3-results-archie-inprogress","dataUrl":"/da-ert-part3-results-archie-inprogress.json","key":"EQx9AdwFb6"}],"key":"eDn5pmIjh1"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Assimilation performance","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jUGD3oIakd"}],"identifier":"da_perf","label":"DA_perf","kind":"heading","template":"{name}","resolved":true,"html_id":"da-perf","remote":true,"url":"/da-ert-part3-results-archie-inprogress","dataUrl":"/da-ert-part3-results-archie-inprogress.json","key":"i0mXLPWi5W"}],"key":"hZQfo4UW60"}],"key":"DufTrWby7N"}],"key":"dfkMsHUTwD"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import pyCATHY\nfrom pyCATHY import cathy_tools\nfrom pyCATHY.DA.cathy_DA import DA, dictObs_2pd\nfrom pyCATHY.DA.perturbate import perturbate_parm\nfrom pyCATHY.DA import perturbate\nfrom pyCATHY.DA.observations import read_observations, prepare_observations, make_data_cov\nfrom pyCATHY.DA import performance\nfrom pyCATHY.ERT import petro_Archie as Archie\nimport pyCATHY.meshtools as cathy_meshtools\nimport pyvista as pv\nimport pyCATHY.plotters.cathy_plots as cplt \nimport os \nimport numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\n# set some default plotting parameters for nicer looking plots\nmpl.rcParams.update({\"axes.grid\":True, \n                     \"grid.color\":\"gray\", \n                     \"grid.linestyle\":'--',\n                     'figure.figsize':(6,6)}\n                   )\nimport pandas as pd\nimport utils","key":"oMUmkclUOy"},{"type":"output","id":"HXur77igFViJX2Uin5ltG","data":[],"key":"yRXyghaicY"}],"key":"xqr1RpHjNs"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import pygimli as pg \nfrom pygimli.physics import ert","key":"TI9PKrSTk9"},{"type":"output","id":"bcXiGEMKxlnIfMBwc26r6","data":[],"key":"MSdynqwooK"}],"key":"xdqc8EVkoB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Analysis of the results","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sSnHrgoQAj"}],"identifier":"plot_results","label":"plot_results","html_id":"plot-results","key":"teQri5W40m"}],"key":"zYpIHtZKJz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reload solution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F0DxilAZeb"}],"identifier":"reload-solution","label":"Reload solution","html_id":"reload-solution","implicit":true,"key":"tG2UYMqqkk"}],"key":"pbEJ6HGYFE"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"simu_solution = cathy_tools.CATHY(\n                                    dirName='./solution_ERT',\n                                    prj_name= 'weill_dataset',\n                                    notebook=True,\n                                  )\nsw_SOL, sw_SOL_times = simu_solution.read_outputs('sw')\npsi_SOL = simu_solution.read_outputs('psi')\n\nrootMap, rootMap_hd = simu_solution.read_inputs('root_map')\n\nsoil_SPP_SOL, soil_FP_SOL = simu_solution.read_inputs('soil',\n                                                         MAXVEG=int(np.max(rootMap)),\n                                                    )\nPERMX_SOL = soil_SPP_SOL['PERMX'].unique()[0]\nPOROS_SOL = soil_SPP_SOL['POROS'].unique()[0]","key":"NcM5to3hZa"},{"type":"output","id":"T6IeAswjFXxIWd9811eve","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cpre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"\u003e🏁 \u003cspan style=\"font-weight: bold\"\u003eInitiate CATHY object\u003c/span\u003e\n\u003c/pre\u003e\n","content_type":"text/html"},"text/plain":{"content":"🏁 \u001b[1mInitiate CATHY object\u001b[0m\n","content_type":"text/plain"}}}],"key":"aRVMZIXaDm"}],"key":"ZJBc3UQpDl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot saturation 2D solution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jTMQC7gPlL"}],"identifier":"plot-saturation-2d-solution","label":"Plot saturation 2D solution","html_id":"plot-saturation-2d-solution","implicit":true,"key":"iroHsNNdq3"}],"key":"I6Ix85Cxt1"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"pl = pv.Plotter(shape=(2, 2))\naxis_pl = [(0,0),(0,1),(1,0),(1,1)]\nfor i, j in enumerate([0,2,5,10]):\n    mesh = pv.read(os.path.join(simu_solution.workdir,\n                                'solution_ERTsaturation_nearIntrp2_pg_msh' + str(j) + '.vtk',\n                                )\n    \n           )\n    pl.subplot(axis_pl[i][0],axis_pl[i][1])\n    pl.add_mesh(mesh,\n               scalars='saturation_nearIntrp2_pg_msh',\n                lighting=False,\n                cmap=\"jet_r\"\n               )\n    pl.view_xz()\npl.show()","key":"gVFp9fPMNF"},{"type":"output","id":"uanRxPesKXhUGuYgQW9vv","data":[{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"6e31cb55382345f831227f14f8430ca4","path":"/build/6e31cb55382345f831227f14f8430ca4.jpeg"},"image/png":{"content_type":"image/png","hash":"6ae9872eb651581ce270554502af7ba2","path":"/build/6ae9872eb651581ce270554502af7ba2.png"},"text/plain":{"content":"\u003cPIL.Image.Image image mode=RGB size=1024x768\u003e","content_type":"text/plain"}}}],"key":"HJ1Dpf9Tb5"}],"key":"qAsYsrnqPM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Going further with pygimli Time Lapse","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CaexXv6VmN"}],"identifier":"going-further-with-pygimli-time-lapse","label":"Going further with pygimli Time Lapse","html_id":"going-further-with-pygimli-time-lapse","implicit":true,"key":"PiRMSgWGjL"}],"key":"uVqrClcMMd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In case we want to see the results in term of ER, we can invert the apparent resistivities. See: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gb9ytFcZFR"},{"type":"link","url":"https://www.pygimli.org/_examples_auto/3_ert/plot_09_timelapse.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​www​.pygimli​.org​/​_examples​_auto​/3​_ert​/plot​_09​_timelapse​.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DL8Gqa0Ez5"}],"urlSource":"https://www.pygimli.org/_examples_auto/3_ert/plot_09_timelapse.html","key":"Ifbw4d9IaF"}],"key":"ciGZyeZB7s"},{"type":"code","lang":"","value":"for i in range(10):\n    rhoa = pg.load('filenameRhoa_synthetic')\n    DATA.append(rhoa)\n\ntl = ert.TimelapseERT(DATA)\ntl.invert(zWeight=0.3, lam=100)\ntl.showAllModels();","position":{"start":{"line":3,"column":1},"end":{"line":11,"column":1}},"key":"DU73ZUAwOj"}],"key":"iupS1dzMH0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reload DA results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OegtpLwA29"}],"identifier":"reload-da-results","label":"Reload DA results","html_id":"reload-da-results","implicit":true,"key":"stnEa4HzaL"}],"key":"nZ3OZj4PMs"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"simuWithDA = DA(\n                        dirName='./DA_ERT',\n                        prj_name= 'Weill_example_withDA',\n                        notebook=True,\n                    )\nsimuWithoutDA = DA(\n                        dirName='./DA_ERT',\n                        prj_name= 'Weill_example_withoutDA',\n                        notebook=True,\n                    )","key":"S90JonUtwv"},{"type":"output","id":"nZ-rFRxXD1XyNfaAc9ZJ7","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cpre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"\u003e🏁 \u003cspan style=\"font-weight: bold\"\u003eInitiate CATHY object\u003c/span\u003e\n\u003c/pre\u003e\n","content_type":"text/html"},"text/plain":{"content":"🏁 \u001b[1mInitiate CATHY object\u001b[0m\n","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cpre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"\u003e🏁 \u003cspan style=\"font-weight: bold\"\u003eInitiate CATHY object\u003c/span\u003e\n\u003c/pre\u003e\n","content_type":"text/html"},"text/plain":{"content":"🏁 \u001b[1mInitiate CATHY object\u001b[0m\n","content_type":"text/plain"}}}],"key":"r78svRuVvY"}],"key":"SktQdRpZ3q"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"results_withDA = simuWithDA.load_pickle_backup()\nresults_withoutDA = simuWithoutDA.load_pickle_backup()","key":"WKmYBPNpvE"},{"type":"output","id":"V0jrpw8hmjoqGvu9CSefV","data":[],"key":"E8d62wJ0fb"}],"key":"DNL2jhXwlj"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"observations = dictObs_2pd(results_withDA['dict_obs'])\n#observations.xs('ERT',0).iloc[0]['elecs']","key":"cXg8vdOy5b"},{"type":"output","id":"xpsdawXIf3dQ2z0BzR7Rk","data":[],"key":"AfsFtdYk2e"}],"key":"rGC41S8OJr"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"tobs= observations.index.get_level_values(1).to_list()","key":"ChjW70aHir"},{"type":"output","id":"70iJIKknpXphXJhegDlnF","data":[],"key":"VFLcbh2x4C"}],"key":"wflbPfDlGY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ERT simulate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DmCr4X5KoY"}],"identifier":"ert-simulate","label":"ERT simulate","html_id":"ert-simulate","implicit":true,"key":"sFwpcc2z14"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we simulate the apparent resistivities from the mean/min/max of the ensemble generated from data assimilation for each steps.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LY3wgtGqwK"}],"key":"qgcx5JL3Bi"}],"key":"FqxUPFXXx6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"os.getcwd()","key":"ZlGjkkiaGT"},{"type":"output","id":"e0nQ7a6NElPw1q6y4l-7r","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"'/home/z0272571a@CAMPUS.CSIC.ES/Nextcloud/BenCSIC/Codes/BenjMy/ETH_pyCATHY/notebooks'","content_type":"text/plain"}}}],"key":"QnFKM17kP1"}],"key":"RCigq974hc"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"meshCiPG_PGref = pv.read('./solution_ERT/meshCi.vtk')\nmeshLiPG_PGref = pv.read('./solution_ERT/meshLi.vtk')\n(meshCiPG, meshLiPG) = utils.define_mesh_transformations(meshCiPG_PGref,\n                                                      meshLiPG_PGref,\n                                                      idC=10, \n                                                      idL=10,\n                                                    )","key":"u3yjDZmDGr"},{"type":"output","id":"SB4AQS_HmrOp52HkR8wjD","data":[],"key":"Tce8HxSoDZ"}],"key":"rLa08YW8Gf"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"meshLiPG","key":"VvwAnl9ayh"},{"type":"output","id":"gHi7YMcF_6lAjorSktlaB","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"\u003ctable style='width: 100%;'\u003e\u003ctr\u003e\u003cth\u003eHeader\u003c/th\u003e\u003cth\u003eData Arrays\u003c/th\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\n\u003ctable style='width: 100%;'\u003e\n\u003ctr\u003e\u003cth\u003eUnstructuredGrid\u003c/th\u003e\u003cth\u003eInformation\u003c/th\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eN Cells\u003c/td\u003e\u003ctd\u003e3114\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eN Points\u003c/td\u003e\u003ctd\u003e1658\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eX Bounds\u003c/td\u003e\u003ctd\u003e0.000e+00, 1.000e+01\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eY Bounds\u003c/td\u003e\u003ctd\u003e5.000e+00, 5.000e+00\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eZ Bounds\u003c/td\u003e\u003ctd\u003e-1.000e+00, 7.500e-01\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eN Arrays\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003c/tr\u003e\n\u003c/table\u003e\n\n\u003c/td\u003e\u003ctd\u003e\n\u003ctable style='width: 100%;'\u003e\n\u003ctr\u003e\u003cth\u003eName\u003c/th\u003e\u003cth\u003eField\u003c/th\u003e\u003cth\u003eType\u003c/th\u003e\u003cth\u003eN Comp\u003c/th\u003e\u003cth\u003eMin\u003c/th\u003e\u003cth\u003eMax\u003c/th\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e\u003cb\u003eMarker\u003c/b\u003e\u003c/td\u003e\u003ctd\u003eCells\u003c/td\u003e\u003ctd\u003efloat64\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003ctd\u003e1.000e+00\u003c/td\u003e\u003ctd\u003e1.000e+00\u003c/td\u003e\u003c/tr\u003e\n\u003c/table\u003e\n\n\u003c/td\u003e\u003c/tr\u003e \u003c/table\u003e","content_type":"text/html"},"text/plain":{"content":"UnstructuredGrid (0x7f3651daa860)\n  N Cells:    3114\n  N Points:   1658\n  X Bounds:   0.000e+00, 1.000e+01\n  Y Bounds:   5.000e+00, 5.000e+00\n  Z Bounds:   -1.000e+00, 7.500e-01\n  N Arrays:   1","content_type":"text/plain"}}}],"key":"UJc7OjvagC"}],"key":"wGGSK5H0zy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"meshLiPG is composed of 3114 cells and 1658 nodes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M4BtcRKHaj"}],"key":"XPb3C7e6Af"}],"key":"sDj11q6dik"}],"key":"R8Q3xu5Bbz"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"pl = pv.Plotter()\npl.add_mesh(meshCiPG)\npl.add_mesh(meshLiPG)\n#pl.add_mesh(meshCATHY,opacity=0.5)\npl.show_grid()\npl.show()","key":"uZCirgWOiD"},{"type":"output","id":"PlgmJrdEdOIfVXMdfoofS","data":[{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"3d94c89eece1c805a6a26d55da8602f4","path":"/build/3d94c89eece1c805a6a26d55da8602f4.jpeg"},"image/png":{"content_type":"image/png","hash":"0a59c637b77ab96fdbe7b19cf8fa1d13","path":"/build/0a59c637b77ab96fdbe7b19cf8fa1d13.png"},"text/plain":{"content":"\u003cPIL.Image.Image image mode=RGB size=1024x768\u003e","content_type":"text/plain"}}}],"key":"ZHLPKYl9r9"}],"key":"I0lalIZGJI"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ERT_meta_dict_meshLi={\n                'forward_mesh_vtk_file': './solution_ERT/meshLi.vtk',\n                'mesh_nodes_modif': meshLiPG.points\n}","key":"TXL3IDeQoA"},{"type":"output","id":"qVuIuHEGHjwwQmRr1s0HS","data":[],"key":"NIJBGacq8v"}],"key":"vW4AZ4aBXD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Archie Parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WIPVeDXzxO"}],"identifier":"define-archie-parameters","label":"Define Archie Parameters","html_id":"define-archie-parameters","implicit":true,"key":"uulSU2uVX7"}],"key":"XOQCIRzrrs"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"sc = {}\nrFluid_Archie = 1/(588*(1e-6/1e-2))\nsc = {\n    \"POROS\": [POROS_SOL],\n    \"rFluid_Archie\": [rFluid_Archie],\n    \"a_Archie\": [0.3],\n    \"m_Archie\": [1.7],\n    \"n_Archie\": [1.7],\n    \"pert_sigma_Archie\": [0],\n}","key":"pmrwGmyeqM"},{"type":"output","id":"Nnr-1NwlsXH5Pd9SBnHGT","data":[],"key":"jDGX8yZpiz"}],"key":"j7wbCpswMK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"","key":"IshGpuS8Du"},{"type":"output","id":"Q0CcXniJCYfgm2sA_03el","data":[{"ename":"NameError","evalue":"name 'meshCATHY' is not defined","output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)\nCell \u001b[0;32mIn[32], line 1\u001b[0m\n\u001b[0;32m----\u003e 1\u001b[0m meshLi_PG_withSaturation, scalar_new \u001b[38;5;241m=\u001b[39m cathy_meshtools\u001b[38;5;241m.\u001b[39mCATHY_2_pg(meshCATHY,\n\u001b[1;32m      2\u001b[0m                                                                   ERT_meta_dict_meshLi,\n\u001b[1;32m      3\u001b[0m                                                                   \u001b[38;5;66;03m# show=True,\u001b[39;00m\n\u001b[1;32m      4\u001b[0m                                                                   )\n\n\u001b[0;31mNameError\u001b[0m: name 'meshCATHY' is not defined"}],"key":"OCU3oCtP83"}],"key":"D17a6PFpah"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create ERT scheme","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LqPIXyOJaT"}],"identifier":"create-ert-scheme","label":"Create ERT scheme","html_id":"create-ert-scheme","implicit":true,"key":"Yo3ozOUdVs"}],"key":"xNyARZkkCJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"scheme = ert.createData(elecs=np.linspace(start=0, \n                                          stop=10, \n                                          num=21),\n                           schemeName='dd')","key":"hUbCKP6wmW"},{"type":"output","id":"bswYwbwPfKNGtQf3BlTJM","data":[],"key":"RAKLy2izfq"}],"key":"l7dbbIMKNB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"meshLi = pg.load(ERT_meta_dict_meshLi['forward_mesh_vtk_file'])","key":"Ik1MLvJKul"},{"type":"output","id":"G4hbMru5DR0d6EADWjQIf","data":[],"key":"IrUkGEsaVr"}],"key":"AGghJETmaQ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"sw_bef_update_withDA_ens1 = results_withDA['df_DA'].set_index(['time','Ensemble_nb'])['sw_bef_update_'].xs((1,0))","key":"RZFc76alxg"},{"type":"output","id":"BYcHTnMQl4qEDG2KHu-7b","data":[],"key":"tzAtajxxRt"}],"key":"HOdmjabhEe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"results_withDA_Archie = results_withDA['df_Archie'].set_index(['time','ens_nbi'])\nresults_withDA_Archie","key":"hNL2Tnm11W"},{"type":"output","id":"gaN94tNF73_vS79Y1yP1a","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eens_nb\u003c/th\u003e\n      \u003cth\u003esw\u003c/th\u003e\n      \u003cth\u003eER_converted\u003c/th\u003e\n      \u003cth\u003eOL\u003c/th\u003e\n      \u003cth\u003eporosity\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003eens_nbi\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth rowspan=\"5\" valign=\"top\"\u003e0.0\u003c/th\u003e\n      \u003cth\u003e0.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.672994\u003c/td\u003e\n      \u003ctd\u003e27.638137\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.672602\u003c/td\u003e\n      \u003ctd\u003e27.665519\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.672672\u003c/td\u003e\n      \u003ctd\u003e27.660611\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.672713\u003c/td\u003e\n      \u003ctd\u003e27.657710\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.672787\u003c/td\u003e\n      \u003ctd\u003e27.652588\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth rowspan=\"5\" valign=\"top\"\u003e9.0\u003c/th\u003e\n      \u003cth\u003e31.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.272770\u003c/td\u003e\n      \u003ctd\u003e128.313890\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e31.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.272770\u003c/td\u003e\n      \u003ctd\u003e128.313970\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e31.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.272770\u003c/td\u003e\n      \u003ctd\u003e128.313970\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e31.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.272770\u003c/td\u003e\n      \u003ctd\u003e128.313970\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e31.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.272769\u003c/td\u003e\n      \u003ctd\u003e128.314130\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.55\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e1439424 rows × 5 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"             ens_nb        sw  ER_converted   OL  porosity\ntime ens_nbi                                              \n0.0  0.0        NaN  0.672994     27.638137  0.0      0.55\n     0.0        NaN  0.672602     27.665519  0.0      0.55\n     0.0        NaN  0.672672     27.660611  0.0      0.55\n     0.0        NaN  0.672713     27.657710  0.0      0.55\n     0.0        NaN  0.672787     27.652588  0.0      0.55\n...             ...       ...           ...  ...       ...\n9.0  31.0       NaN  0.272770    128.313890  0.0      0.55\n     31.0       NaN  0.272770    128.313970  0.0      0.55\n     31.0       NaN  0.272770    128.313970  0.0      0.55\n     31.0       NaN  0.272770    128.313970  0.0      0.55\n     31.0       NaN  0.272769    128.314130  0.0      0.55\n\n[1439424 rows x 5 columns]","content_type":"text/plain"}}}],"key":"TjbUt9TJyv"}],"key":"A55fkVdaZF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"rhomap = results_withDA_Archie.xs((0,0))['ER_converted'].values\nlen(rhomap)\n","key":"CsNy3AyApV"},{"type":"output","id":"gnH2PeRANy_8r5ZHTIlUN","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"7056","content_type":"text/plain"}}}],"key":"z7IWqw4yid"}],"key":"nsrEzmn5tf"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"len(rhomap)","key":"BtmXgLc9zr"},{"type":"output","id":"VttAK5fePy8e847ajM_Yb","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"7056","content_type":"text/plain"}}}],"key":"Ou632QWZW8"}],"key":"TZooIguKVh"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"meshLi","key":"dE2GUQ80Qt"},{"type":"output","id":"UcI0p2sZ7t5X8aaMRvkpi","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"Mesh: Nodes: 1658 Cells: 3114 Boundaries: 4771\nMesh contains data: Marker","content_type":"text/plain"}}}],"key":"IiKZWXQEHr"}],"key":"JLpQtaHXC2"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"os.getcwd()","key":"T6VxQwuNoY"},{"type":"output","id":"12s_5cC9kPTy1c8mdBO5T","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"'/home/z0272571a@CAMPUS.CSIC.ES/Nextcloud/BenCSIC/Codes/BenjMy/ETH_pyCATHY/notebooks'","content_type":"text/plain"}}}],"key":"R6eDNCIde1"}],"key":"xPau8M62Uq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"for i in range(len(tatmbc)):\n\n    # read in CATHY mesh data\n    # ------------------------------------------------------------------------\n    path_CATHY = os.path.join(simu_solution.workdir, \n                              simu_solution.project_name , \n                              'vtk/'\n                              )\n    if i\u003c10:    \n        filename = \"10\" + str(i) + \".vtk\"\n    elif i\u003c100:\n        filename = \"1\" + str(i) + \".vtk\"\n    \n    meshCATHY = pv.read(path_CATHY+filename)\n            \n    meshLi_PG_withSaturation, scalar_new = cathy_meshtools.CATHY_2_pg(meshCATHY,\n                                                                      ERT_meta_dict_meshLi,\n                                                                      # show=True,\n                                                                      )","key":"wdg3zXZTxs"},{"type":"output","id":"Lgha7R8Renrm-45L6N0mM","data":[],"key":"L3lOktd6ST"}],"key":"QeIErozdlj"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"\nfor i in range(len(tobs)):\n    rhomap = results_withDA_Archie.xs((0,0))['ER_converted'].values\n    print(rhomap)\n\n    meshLi_PG_withSaturation, scalar_new = cathy_meshtools.CATHY_2_pg(meshCATHY,\n                                                                  ERT_meta_dict_meshLi,\n                                                                  # show=True,\n                                                                  )\n\n    ER_converted_ti_noNoise = Archie.Archie_rho_DA(\n                                               sat = [saturation],\n                                               rFluid_Archie=sc['rFluid_Archie'], \n                                               porosity=sc['POROS'], \n                                               a_Archie=sc['a_Archie'], \n                                               m_Archie=sc['m_Archie'], \n                                               n_Archie=sc['n_Archie'],\n                                               pert_sigma_Archie=[0]\n                                               )\n\n    data = ert.simulate(meshLi, \n                        scheme=scheme, \n                        res=rhomap, \n                        noiseLevel=1,\n                        noiseAbs=1e-6, \n                        seed=1337\n                        )\n    print(i)\n    data.save('DA_ERT/ERTsimuWithDA/ERT_Li_' + str(i) + '.data')","key":"Aki8kdEenL"},{"type":"output","id":"RY5Akq4knrbLKVYt_dS5a","data":[{"name":"stdout","output_type":"stream","text":"[27.6381372  27.66551909 27.66061108 ... 14.09702132 14.09702132\n 14.09702132]\nModellingBase::setMesh() copying new mesh ... Found Neumann domain. Setting topography=1.\nFound Neumann domain. but 2.5D -\u003e neumann: false\nMesh: Nodes: 1658 Cells: 3114 Boundaries: 4771\nMesh contains data: Marker\nres:  [27.6381372  27.66551909 27.66061108 ... 14.09702132 14.09702132\n 14.09702132]\nFound datafile: 21 electrodes\nFound: 21 free-electrodes\nrMin = 0.25, rMax = 20\nNGauLeg + NGauLag for inverse Fouriertransformation: 11 + 4\nFound non-Neumann domain\n0.00733017 s\nFOP updating mesh dependencies ... 1.072e-06 s\n"},{"ename":"BaseException","evalue":"Simulate called with wrong resistivity array.","output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mBaseException\u001b[0m                             Traceback (most recent call last)\nCell \u001b[0;32mIn[29], line 4\u001b[0m\n\u001b[1;32m      2\u001b[0m rhomap \u001b[38;5;241m=\u001b[39m results_withDA_Archie\u001b[38;5;241m.\u001b[39mxs((\u001b[38;5;241m0\u001b[39m,\u001b[38;5;241m0\u001b[39m))[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mER_converted\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mvalues\n\u001b[1;32m      3\u001b[0m \u001b[38;5;28mprint\u001b[39m(rhomap)\n\u001b[0;32m----\u003e 4\u001b[0m data \u001b[38;5;241m=\u001b[39m ert\u001b[38;5;241m.\u001b[39msimulate(meshLi, \n\u001b[1;32m      5\u001b[0m                     scheme\u001b[38;5;241m=\u001b[39mscheme, \n\u001b[1;32m      6\u001b[0m                     res\u001b[38;5;241m=\u001b[39mrhomap, \n\u001b[1;32m      7\u001b[0m                     noiseLevel\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m,\n\u001b[1;32m      8\u001b[0m                     noiseAbs\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1e-6\u001b[39m, \n\u001b[1;32m      9\u001b[0m                     seed\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1337\u001b[39m\n\u001b[1;32m     10\u001b[0m                     )\n\u001b[1;32m     11\u001b[0m \u001b[38;5;28mprint\u001b[39m(i)\n\u001b[1;32m     12\u001b[0m data\u001b[38;5;241m.\u001b[39msave(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDA_ERT/ERTsimuWithDA/ERT_Li_\u001b[39m\u001b[38;5;124m'\u001b[39m \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(i) \u001b[38;5;241m+\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m.data\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\nFile \u001b[0;32m~/miniconda3/envs/pgCATHY/lib/python3.11/site-packages/pygimli/physics/ert/ert.py:215\u001b[0m, in \u001b[0;36msimulate\u001b[0;34m(mesh, scheme, res, **kwargs)\u001b[0m\n\u001b[1;32m    213\u001b[0m         \u001b[38;5;28mprint\u001b[39m(mesh)\n\u001b[1;32m    214\u001b[0m         \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mres: \u001b[39m\u001b[38;5;124m\"\u001b[39m, res)\n\u001b[0;32m--\u003e 215\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mBaseException\u001b[39;00m(\n\u001b[1;32m    216\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mSimulate called with wrong resistivity array.\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m    218\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m isArrayData:\n\u001b[1;32m    219\u001b[0m     ret[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrhoa\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m rhoa\n\n\u001b[0;31mBaseException\u001b[0m: Simulate called with wrong resistivity array."}],"key":"cJjd3nDtcE"}],"key":"adXorq1cyQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Archie","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ozZyzNptTG"}],"identifier":"archie","label":"Archie","html_id":"archie","implicit":true,"key":"hLhBgAtLAZ"}],"key":"I8dT5M0zhP"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"results_withDA.keys()","key":"SItSkTbe2P"},{"type":"output","id":"Bi1K66l2rWMwOXeDsNmxx","data":[],"key":"LnWUmSKRdK"}],"key":"cWOCf3f755"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"Archie = results_withDA['df_Archie']\nArchie_ER = Archie.set_index(['time','ens_nbi'])\nArchie_ER","key":"Pi4jxvrRYx"},{"type":"output","id":"0i-cWHkJ0-GM8nukjfcuj","data":[],"key":"WF1kWcZ7fW"}],"key":"MokWh981PS"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"Archie.time.unique()","key":"I9GVWl9OdL"},{"type":"output","id":"HtZvDw_zNFKRiLsKf9D0z","data":[],"key":"Gle59dGISo"}],"key":"IKWMWHPYhR"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"meanArchie = Archie.groupby('time')['ER_converted'].mean()\nminArchie = Archie.groupby('time')['ER_converted'].min()\nmaxArchie = Archie.groupby('time')['ER_converted'].max()\nminArchie","key":"HDOAtltahd"},{"type":"output","id":"cJWmf6_vtqJVrfMCKGmDE","data":[],"key":"eN6ZGzXvdb"}],"key":"lcJUKAjJLh"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots()\nminArchie.plot(ax=ax)\nmaxArchie.plot(ax=ax)\nmeanArchie.plot(ax=ax)\nax.set_xlabel('# Assimilation')\nax.set_ylabel('ER converted')\n","key":"LbHFoV5ee9"},{"type":"output","id":"4ehziH3zNVJXEzYlWlbMQ","data":[],"key":"kZ9NyJXmt8"}],"key":"zFQ3u9I4A6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot 1:1 line between observed ER and estimated ER","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kWMlKOAbq8"}],"identifier":"plot-1-1-line-between-observed-er-and-estimated-er","label":"Plot 1:1 line between observed ER and estimated ER","html_id":"plot-1-1-line-between-observed-er-and-estimated-er","implicit":true,"key":"uHisq3uI5n"}],"key":"LMVb9r0dQm"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"Archie['ER_converted']","key":"QrvH3jXiSL"},{"type":"output","id":"-mt5qD5m5QI-_HdSH5E3q","data":[],"key":"erLOhEyO2O"}],"key":"CKXRigjbF4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"metadata_ERT    = {\n                    'data_type': '$ERT$', # units\n                    'units': '$\\Ohm$', # units transfer_resistances\n                    'forward_mesh_vtk_file': '../solution_ERT/meshLi.vtk', # path to the ERT mesh (vtk file compatible with pygimli or resipy)\n                    # 'sequenceERT': sequenceERT, # path to the ERT sequence  (file compatible with pygimli or resipy)\n                    # 'instrument': 'Syscal', # Instrument\n                    'data_format': 'pygimli', # format (raw or preprocessed)\n                    'dataErr': 0.5, # error in %\n                    'fwdNoiseLevel': 5, # error in %\n                    #'mesh_nodes_modif': meshLiPG.points, \n        \n                }","key":"eR4dz7lreZ"},{"type":"output","id":"xauk-GIwoSytU_EQiMWCP","data":[],"key":"Ty0J3vbgm7"}],"key":"VlSPXxgB5H"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"dict_obs = {}\nfor i, tt in enumerate(Archie.time.unique()):\n\n    if i == 0:\n        continue\n    \n    # .data file observation generated by pygimli\n    filename = os.path.join(simu_solution.workdir,\n                            'ERTsolution', \n                            'ERT_Li_' + str(i) + '.data'\n                            )    \n    data_measure = read_observations(\n                                    dict_obs,\n                                    filename, \n                                    data_type = 'ERT', \n                                    data_err = 0.5,\n                                    show=True,\n                                    tA=tt,\n                                    obs_cov_type='data_err', #data_err\n                                    meta=metadata_ERT,\n                                    ) \ndata_measure_df = dictObs_2pd(dict_obs) ","key":"n7juoo2OCu"},{"type":"output","id":"ZjOMAREZM9YUKaN-pRLoV","data":[],"key":"Sv0QvN9oY9"}],"key":"Jtv0cPv1B0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"data_rhoa = data_measure_df.xs('ERT')['data']\ndata_rhoa.iloc[0].head()","key":"UuE3GHHmOf"},{"type":"output","id":"J4MyNuWHzhg4b2-xzteWv","data":[],"key":"IJ2aRlnJbV"}],"key":"RiReXeQT7z"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots() \nax.scatter(data_rhoa.iloc[0]['rhoa'].values,\n           Archie.groupby('ens_nbi')['ER_converted'].mean().values\n          )\n           ","key":"PEB2KLigJo"},{"type":"output","id":"-4lJyrQI5O7JSYzTKVrJu","data":[],"key":"n1WDEpyWOs"}],"key":"UmXCVxhxVa"}],"key":"ZRZCPv3QaE"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Working with pyCATHY and DA with ERT datasets","url":"/da-ert-part3-results-archie-inprogress","group":"Notebook"},"next":{"title":"Working with pyCATHY and DA","url":"/da-smc-sensors-part1-solution","group":"Notebook"}}},"domain":"http://localhost:3000"},"project":{"github":"https://github.com/BenjMy/ETH_pyCATHY","keywords":[],"id":"9ccbb88f-e40f-414b-8884-6d4ec2e81795","exports":[],"bibliography":[],"title":"Introduction","index":"readme","pages":[{"slug":"resultsda","title":"Twin experiments to test DA","description":"","date":"","thumbnail":"/build/atmbc-f09b5504b84b8c8eec07ec45739288f2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"title":"Notebook","level":1},{"slug":"da-ert-part1-solution","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part2-runda","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part3-results-archie-inprogress","title":"Working with pyCATHY and DA with ERT datasets","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-ert-part3-results-ert-inprogress","title":"Working with pyCATHY and DA with ERT datasets","description":"","date":"2024/04/12","thumbnail":"/build/fedda32be756a7bce4ae368a71151cc1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-smc-sensors-part1-solution","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-smc-sensors-part2-plotda","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"da-swc-ert-performance","title":"Working with pyCATHY and DA","description":"","date":"2024/04/12","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-478A7961.js";
import * as route0 from "/build/root-MAN6ELAR.js";
import * as route1 from "/build/routes/$-KBJJKE3L.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-K6EYMIDZ.js");</script></body></html>